$(()=>{let a,t=!1;async function o(t){t&&($("img#icon").attr("src",`https://openweathermap.org/img/wn/${t.weather[0].icon}@2x.png`),$("link#IconLink").attr("href",`https://openweathermap.org/img/wn/${t.weather[0].icon}@2x.png`)),window.onresize=resize=()=>{window.innerWidth<=800?($("nav").removeClass("d-inline-flex"),$("nav").addClass("d-flex flex-row"),$("nav a").addClass("w-100"),$("nav div").addClass("w-100"),$("nav a").removeClass("w-auto"),$("nav div").removeClass("w-auto"),$("div#Body").removeClass("justify-content-around mt-11"),$("div#Body").addClass("flex-column mt-30"),$("div#CardGeo").addClass("mt-1")):window.innerWidth>=801&&($("nav").addClass("d-inline-flex"),$("nav").removeClass("d-flex flex-row"),$("nav a").removeClass("w-100"),$("nav div").removeClass("w-100"),$("nav a").addClass("w-auto"),$("nav div").addClass("w-auto"),$("div#Body").addClass("justify-content-around mt-11"),$("div#Body").removeClass("flex-column mt-30"),$("div#CardGeo").removeClass("mt-1"))},resize(),await $.post("/notif",{type:"ui"},t=>{a=t}),void 0===$("div#UIToast")[0]&&$("div#notif").append(a),$("div#UIToast").toast("show")}var e={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};async function s(e){$("svg#IconNotifGeo").removeClass("text-danger"),$("svg#IconNotifGeo").addClass("text-success"),$("#loadData").show(),$("p#AccuracyGeo").html(Math.round(e.coords.accuracy)+" %"),t=!0,await $.post("/notif",{type:"geo"},t=>{a=t}),$("div#notif").html(a),$("div#GeoToast").toast("show"),await $.post("/env",{list:"API_OWM_*"},async a=>{await $.get(`${a.API_OWM_LINK}lat=${e.coords.latitude}&lon=${e.coords.longitude}${a.API_OWM_KEY}`,async t=>{o(t),await $.get("https://restcountries.eu/rest/v2/alpha/"+t.sys.country,async o=>{$("img#NotifPaysFlag").attr("src",""+o.flag),$("p#NotifPays").html(t.sys.country),await $.get(`${a.API_OWM_LINKUV}lat=${e.coords.latitude}&lon=${e.coords.longitude+a.API_OWM_KEY}`,async a=>{await $.post("/meteo",{data:t,DataJsonCountry:o,UV:a},a=>{$("div#Body").html(a),$("#loadData").hide()})})})})})}async function i(e){$("svg#IconNotifGeo").addClass("text-danger"),$("svg#IconNotifGeo").removeClass("text-success"),$("p#AccuracyGeo").html("0 %"),t=!1,o(void 0),await $.post("/notif",{type:"geoError"},t=>{a=t}),$("div#notif").html(a),$("div#GeoToast").toast("show"),$("#loadData").hide(),$("button#RetryGeo").click(a=>{n()})}function n(){navigator.geolocation.getCurrentPosition(s,i,e)}async function l(){$("#loadData").show(),$.post("/env",{list:"API_OWM_*"},a=>{$.ajax({type:"get",url:a.API_OWM_LINK+"q="+$("input#INameVille").val()+a.API_OWM_KEY,success:function(t){o(t),$.get("https://restcountries.eu/rest/v2/alpha/"+t.sys.country,o=>{$.get(`${a.API_OWM_LINKUV}lat=${t.coord.lat}&lon=${t.coord.lon+a.API_OWM_KEY}`,a=>{$.post("/meteo",{data:t,DataJsonCountry:o,UV:a},a=>{$("div#Body").html(a),$("#loadData").hide()})})})},error:function(a){$("input#INameVille").addClass("is-invalid")}})})}n(),$("button#nameVille").click(a=>{""===$("input#INameVille").val()&&$("input#INameVille").addClass("is-invalid"),""!==$("input#INameVille").val()&&l()}),$(window).keypress(a=>{"Enter"===a.key&&(""===$("input#INameVille").val()&&$("input#INameVille").addClass("is-invalid"),""!==$("input#INameVille").val()&&l())})});
